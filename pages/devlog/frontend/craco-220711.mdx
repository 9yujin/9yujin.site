import { Img } from "components";

# [React] ì ˆëŒ€ê²½ë¡œ ì„¤ì •í•˜ê¸° (with TS, Storybook, CRA, Craco)

_2022.07.11_

í”„ë¡œì íŠ¸ê°€ ê·œëª¨ê°€ ì»¤ì§€ê³  ëìŠ¤ê°€ ê¹Šì–´ì§€ë©´ì„œ íŒŒì¼ì„ import í•´ì˜¬ë•Œë§ˆë‹¤ ë²ˆê±°ë¡œì›Œì¡Œë‹¤. `../`ì´ 4ê°œë¼ë‹ˆ. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ë¦¬ì•¡íŠ¸ í™˜ê²½ì—ì„œ ì ˆëŒ€ê²½ë¡œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¸íŒ…ì„ í•´ë³´ì•˜ë‹¤. ì´ë²ˆ ê¸€ì€ ê·¸ ì‚½ì§ˆì˜ ê¸°ë¡.

```tsx
import { useAppDispatch } from "../../../../store/app/hooks";
import { dispatchItemName } from "../../../../store/slices/challengePayloadSlice";
import a1 from "../../../../assets/icons/itemName/a1.svg";
```

## 1\. Cracoë¡œ config ê±´ë“œë¦¬ê¸°

ì ˆëŒ€ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” webpackì˜ configë¥¼ ê±´ë“œë ¤ì•¼ í•œë‹¤. CRAë¡œ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í–ˆë”ë¼ë„ ejectë¥¼ í†µí•´ config íŒŒì¼ì„ êº¼ë‚´ì„œ ìˆ˜ì •í•  ìˆ˜ ìˆì§€ë§Œ, í•œë²ˆ êº¼ë‚´ë©´ ë‹¤ì‹  ëª»ëŒì•„ê°„ë‹¤ê³  ë¦¬ë“œë¯¸ì—ì„œ ê·¸ë ‡ê²Œ ê²ì„ ì£¼ì‹œë‹ˆ..

ì«„íŠ€í•  ë»”í•œ ë‚˜ë¥¼ ìœ„í•œ **CRACO**(create react app configuration override) ë¼ëŠ” íŒ¨í‚¤ì§€ê°€ ìˆë‹¤. ejectë¥¼ í•˜ì§€ ì•Šê³ ë„ ì›¹íŒ©ì„ ê±´ë“¤ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

```bash
$ yarn add @craco/craco
$ yarn add craco-alias -D
```

íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.

#### package.json

```json
{
  // ...
  "scripts": {
    "start": "craco start",
    "build": "craco build",
    "test": "craco test",
    "eject": "react-scripts eject"
  }
  // ...
}
```

react-script ë¡œ ë˜ì–´ìˆë˜ ë¶€ë¶„ì„ cracoê°€ í•´ë‹¹ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ë³€ê²½í•´ì¤€ë‹¤.

#### craco.config.js

```js
const CracoAlias = require("craco-alias");

module.exports = {
  plugins: [
    {
      plugin: CracoAlias,
      options: {
        source: "tsconfig",
        baseUrl: "./",
        tsConfigPath: "./tsconfig.paths.json",
      },
    },
  ],
};
```

root ë””ë ‰í† ë¦¬ì— `craco.config.js`ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ íŒŒì¼ì„ ìƒì„±í•´ì¤€ë‹¤. [craco-alias](https://www.npmjs.com/package/craco-alias)

- `source` : 'options', 'jsconfig', 'tsconfig' ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•œë‹¤.
- `baseUrl` : aliasë¥¼ ìœ„í•œ base urlì„ ì„¤ì •í•œë‹¤.
- `tsConfigPath` : tsconfig íŒŒì¼ì˜ ê²½ë¡œë¥¼ ë„£ëŠ”ë‹¤. sourceê°€ 'tsconfig'ë¡œ ì„¤ì •ë˜ì–´ ìˆì„ ë•Œë§Œ í•„ìš”í•œ ì˜µì…˜.

## 2\. ê²½ë¡œ ì„¤ì •

```bash
 â”œâ”€â”€ .github # PRíƒ¬í”Œë¦¿, ì•¡ì…˜ ì›Œí¬í”Œë¡œìš° ê´€ë ¨
 â”œâ”€â”€ .storybook # ìŠ¤í† ë¦¬ë¶ ì„¸íŒ…
 â”œâ”€â”€ public
 â”œâ”€â”€ src
 â”‚   â”œâ”€â”€ assets # ì•„ì´ì½˜, ì´ë¯¸ì§€, í°íŠ¸ íŒŒì¼ ë“±
 â”‚   â”œâ”€â”€ components # ì»´í¬ë„ŒíŠ¸ ê´€ë ¨ íŒŒì¼
 â”‚   â”‚   â”œâ”€â”€ common
 â”‚   â”‚   â””â”€â”€ [...]
 â”‚   â”œâ”€â”€ hooks # ì»¤ìŠ¤í…€ í›…
 â”‚   â”‚   â”œâ”€â”€ api
 â”‚   â”‚   â”œâ”€â”€ common
 â”‚   â”‚   â””â”€â”€ [...]
 â”‚   â”œâ”€â”€ lib
 â”‚   â”‚   â”œâ”€â”€ api # axios ì„¤ì •
 â”‚   â”‚   â”œâ”€â”€ styles # GlobalStyle, ThemeProvider ê´€ë ¨
 â”‚   â”‚   â”œâ”€â”€ types # type, interface ê´€ë ¨
 â”‚   â”‚   â””â”€â”€ utils # ìœ í‹¸ í•¨ìˆ˜ ê´€ë ¨
 â”‚   â”œâ”€â”€ pages # í˜ì´ì§€ ê´€ë ¨ íŒŒì¼
 â”‚   â”œâ”€â”€ store
 â”‚   â”‚   â”œâ”€â”€ app # store ì„¸íŒ…
 â”‚   â”‚   â””â”€â”€ slices # RTK slice íŒŒì¼ ì‘ì„±
 â”‚   â”œâ”€â”€ App.tsx
 â”‚   â””â”€â”€ index.tsx
 â””â”€â”€ ê°ì¢… ì„¸íŒ… íŒŒì¼ë“¤ê³¼ ë¦¬ë“œë¯¸ íŒŒì¼
```

src ë””ë ‰í† ë¦¬ í•˜ìœ„ì— ìˆëŠ” ë””ë ‰í† ë¦¬ë§ˆë‹¤ aliasë¥¼ ì§€ì •í•´ì£¼ì—ˆë‹¤. í˜„ì¬ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°ëŠ” ì´ë ‡ê²Œ ë˜ì–´ìˆëŠ”ë°, ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ importí•  ì¼ì´ ê±°ì˜ ì—†ëŠ” pagesë¥¼ ì œì™¸í•˜ê³  ë‚˜ë¨¸ì§€ ë‹¤ì„¯ê°œ ë””ë ‰í† ë¦¬ì— ì ìš©ì‹œí‚¬ ì˜ˆì •.

#### tsconfig.paths.json

```json
{
  "compilerOptions": {
    "baseUrl": "./",
    "paths": {
      "@assets/*": ["src/assets/*"],
      "@components/*": ["src/components/*"],
      "@hooks/*": ["src/hooks/*"],
      "@lib/*": ["src/lib/*"],
      "@store/*": ["src/store/*"]
    }
  }
}
```

root ë””ë ‰í† ë¦¬ì— `tsconfig.paths.json`ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ íŒŒì¼ì„ ìƒì„±í•´ì¤€ë‹¤. baseUrlì— srcë¡œ ë„£ê³  ì•„ë˜ pathì—ì„œ srcë¥¼ ë¹¼ë„ ë˜ì§€ë§Œ ìµœëŒ€í•œ ì°¸ê³ í•œ ê¸€ ê·¸ëŒ€ë¡œ..! ë” ì§ê´€ì ìœ¼ë¡œ ë³´ì—¬ì„œ ì¢‹ë‹¤.

#### tsconfig.json

```json
{
  "extends": "./tsconfig.paths.json",
  "compilerOptions": {
    "target": "es6",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noFallthroughCasesInSwitch": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx"
  },
  "include": ["src", "src/custom.d.ts", "craco.config.js"]
}
```

`tsconfig.json` íŒŒì¼ë„ ìˆ˜ì •í•´ì¤€ë‹¤. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ì»´íŒŒì¼í•˜ëŠ”ë° í•„ìš”í•œ ë£¨íŠ¸ íŒŒì¼ê³¼ ì»´íŒŒì¼ëŸ¬ ì˜µì…˜ì„ ì§€ì •í•´ì£¼ëŠ” íŒŒì¼ì´ë‹¤.

- `extends` : ë‹¤ë¥¸ íŒŒì¼ì˜ ì„¤ì •ì„ ìƒì†
- `include` : ì»´íŒŒì¼ í• ë•Œ í¬í•¨í•  í´ë”ë‚˜ íŒŒì¼

ê°ê° ìœ„ì—ì„œ ìƒì„±í•œ `tsconfig.paths.json`ê³¼ `craco.config.js` ì„ ì¶”ê°€í•œë‹¤. extendsë¡œ ë°›ì§€ ì•Šê³  ë°”ë¡œ tsconfig ë‚´ì—ì„œ ì‘ì„±í•´ë„ ë ë“¯?

#### ì–´ë¼?

ë¶„ëª…íˆ ë˜ì•¼ í• í…ë°, ê³„ì† ëª¨ë“ˆì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” ì›¹íŒ© ë¹Œë“œ ì˜¤ë¥˜ê°€ ë‚¬ë‹¤. ì ê¹ ë‹¹í™©í–ˆë‹¤ê°€ ì´ì „ì˜ ê¸°ì–µì„ ì‚´ê¸ˆì‚´ê¸ˆ ì§šì–´ `yarn.lock` ì„ ì‚­ì œí•˜ê³  yarn start ëª…ë ¹ì–´ë¡œ ì‹¤í–‰í•˜ë‹ˆ ì •ìƒì ìœ¼ë¡œ ë˜ì—ˆë‹¤.

```tsx
import { useAppDispatch } from "@store/app/hooks";
import { dispatchItemName } from "@store/slices/challengePayloadSlice";
import a1 from "@assets/icons/itemName/a1.svg";
```

ì´ë ‡ê²Œ ì•„ì£¼ ê¹”ë”í•˜ê³  ëª…ì‹œì ìœ¼ë¡œ importí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

## 3\. Storybookì—ì„œ

ê¸°ìœ ë§ˆìŒìœ¼ë¡œ ìŠ¤í† ë¦¬ë¶ì—ì„œë„ ë˜ë‚˜ í™•ì¸í•´ë³´ë‹ˆ (ë‹¹ì—°íˆ) ë  ë¦¬ê°€ ìˆë‚˜. ìŠ¤í† ë¦¬ë¶ì—ì„  ë‹¹ì—°íˆ ë³„ë„ë¡œ ë¹Œë“œí•˜ê¸° ë•Œë¬¸ì— ì›¹íŒ© ì„¤ì •ì„ ë”°ë¡œ í•´ì¤€ë‹¤.

```bash
yarn add --dev tsconfig-paths-webpack-plugin
```

ìœ„ì˜ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤. tsconfigì˜ pathsì—ì„œ ì§€ì •ëœ ìœ„ì¹˜ì— ìˆëŠ” ëª¨ë“ˆì„ ë¡œë“œí• ë•Œ ì‚¬ìš©í•œë‹¤ê³  ë¬¸ì„œì— ì¨ìˆëŠ”ë° ë¬´ìŠ¨ ë§ì¸ì§€ëŠ” ì˜ ëª¨ë¥´ê² ë‹¤.

```js filename=".storybook/main.js"
const TsconfigPathsPlugin = require('tsconfig-paths-webpack-plugin');
const path = require('path');

module.exports = {
  stories: [...],
  addons: [...],
  webpackFinal: async (config) => {
    config.resolve.plugins.push(
      new TsconfigPathsPlugin({
        configFile: path.resolve(__dirname, '../tsconfig.json'),
      }),
    );
    return config;
  },
  framework: '@storybook/react',
  core: {
    builder: '@storybook/builder-webpack5',
  },
};
```

`main.js` ì—ì„œ ì„¤ì •ì„ ë³€ê²½í•´ì¤€ë‹¤. í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì§ì ‘ ê²½ë¡œë¥¼ ì„¤ì •í•´ì„œ ê°€ì ¸ì˜¤ê²Œ í•˜ëŠ” ê²ƒ..?<br/>
ìƒê°ë³´ë‹¤ ì˜¤ë˜ê±¸ë ¸ë‹¤.

[ì°¸ê³ 1](https://nykim.work/110) [ì°¸ê³ 2](https://www.howdy-mj.me/boilerplate/craco-absolute-paths-setting/) [ì°¸ê³ 3](https://velog.io/@vagabondms/ts-cra-storybook%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90%EC%84%9C-Alias-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0)

---

#### ì¶”ê°€

ì•¡ì…˜ ë¡œê·¸ë¥¼ ë³´ë‹ˆ ìŠ¤í† ë¦¬ë¶ ë°°í¬ì— ì—ëŸ¬ê°€ ë‚˜ìˆì—ˆë‹¤. ë¬´ìŠ¨ì¼ì¸ê°€ í•˜ë‹ˆ...

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbumKuv%2FbtrG4HEI8ox%2Fmt1kv1CuVq9k9XAMR2cK0K%2Fimg.png)

ìœ„ì—ì„œ ì„¤ì¹˜í–ˆë˜ `craco`ì™€ `react-script`ì˜ ì˜ì¡´ì„± ë¬¸ì œì˜€ë‹¤. `peer dependencies`ëŠ” ë‚´ê°€ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì˜ íŠ¹ì • ë²„ì „ê³¼ í˜¸í™˜ëœë‹¤ëŠ” ê²ƒì„ ëœ»í•œë‹¤. `package.json`ì—ì„  `react-script`ì˜ ë²„ì „ì´ 5.0.1ì´ë¼ê³  ëª…ì‹œë˜ì–´ ìˆëŠ”ë°, `craco`ì˜ `dependency`ì—ëŠ” ^4.0.0ì´ë¼ê³  ëª…ì‹œë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²ƒ.

ëŒ€ë‹¤ìˆ˜ ë¸”ë¡œê·¸ì—ëŠ” ì €ê¸° ë¡œê·¸ì— ë‚˜ì™€ ìˆëŠ” ê²ƒ ì²˜ëŸ¼ `--legacy-peer-deps` ì˜µì…˜ì„ ë¶™ì—¬ì„œ ì„¤ì¹˜ë¥¼ í•˜ë¼ê³  ë‚˜ì™€ ìˆë‹¤. ê·¼ë° ì‚¬ì‹¤ ì–´ì œ ê³ ìŠ¤ë½ í”„ë¡œì íŠ¸ì—ì„œ ìŠ¤í† ë¦¬ë¶ ë°°í¬í•˜ë©´ì„œ `@mdx-js/react` íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ëŠ”ë° ë¹„ìŠ·í•œ ì—ëŸ¬ê°€ ìˆì—ˆë‹¤. ê·¸ ë•Œ ì €ë ‡ê²Œ í–ˆë‹¤ê°€ ì•ˆë˜ì„œ ê²°êµ­ ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ì•„ì„œ í–ˆê¸° ë•Œë¬¸ì—, ì € ì˜µì…˜ì„ ë„£ì–´ì„œ í•˜ëŠ” ë°©ë²• ì™¸ì— ë‹¤ë¥¸ê±¸ ì°¾ì•„ë³´ë ¤ í–ˆìŒ.

npm ëŒ€ì‹  yarn ëª…ë ¹ì–´ë¥¼ ì“°ë©´ ë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. [ì°¸ê³ ](https://www.codegrepper.com/code-examples/javascript/npm+install+could+not+resolve+peerDependencies) ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ë• yarnì„ í•­ìƒ ì“°ê¸° ë•Œë¬¸ì— ë°œê²¬í•˜ì§€ ëª»í–ˆë‚˜? ê·¸ë ‡ë‹¤ê¸°ì—” í„°ë¯¸ë„ì— ì•„ë¬´ëŸ° ê²½ê³ ë„ ëœ¨ì§€ ì•Šì•˜ëŠ”ë°. í . ë¯¸ìŠ¤í…Œë¦¬ë‹¤. í•˜ì§€ë§Œ ì»´í“¨í„°ëŠ” ê±°ì§“ë§ì„ í•˜ì§€ ì•Šìœ¼ë‹ˆê¹.

```yaml filename="storybook.yml"
name: Build & Deploy Storybook
on:
  push:
    branches: [dev]
    paths: ["src/components/**"]
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install and Build ğŸ”§
        # This needs an Acces Token stored as "GH_TOKEN" ğŸ‘‡
        run: |
          yarn install
          yarn deploy-storybook -- --ci
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
```

ìŠ¤í† ë¦¬ë¶ ë°°í¬ìš© yml íŒŒì¼ì„ ìœ„ì™€ ê°™ì´ ìˆ˜ì •í•´ì£¼ì—ˆë‹¤. npmì´ ì•„ë‹ˆë¼ yarn ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë„ë¡. devë¡œ í‘¸ì‰¬í•´ì„œ í™•ì¸í•´ë³´ë‹ˆ ë°°í¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì˜ëœë‹¤. ë¬¼ë¡  ë˜‘ê°™ì´ ë²„ì „ ë‹¤ë¥´ë‹¤ëŠ” ê²½ê³ ê°€ ëœ¨ê¸´ í•˜ì§€ë§Œ ë‹¤í–‰ì´ ê²½ê³  ì •ë„ì—ì„œ ëì´ì—ˆë‹¤. ê·¸ëŸ¼ ë„ì»¤ë¡œ ë°°í¬í• ë•Œë„ npmë§ê³  yarn ìœ¼ë¡œ ë°”ê¿”ì•¼ë˜ëŠ”ê±°ì˜€ë‹¤.
